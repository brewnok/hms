<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ROOM F1R1</title>
    <link rel="stylesheet" href="f1r1.css">
  </head>
  <style>
    .masterContainer {
      margin: 15px;
      padding: 40px;
    }
  </style>
  <body>
    <div class="masterContainer">
      <a class="backhome" href="index.html">Home</a>

      <div class="container">
        <div id="personalDetailsRectangle" class="rectangle">
          <h3>Personal Information</h3>
          <form id="personalInfoForm">
            <div class="input-box">
              <label for="name">Name: <span class="mandatory">*</span></label>
              <input type="text" id="name" name="name" required />
            </div>
            <div class="input-box">
              <label for="adults">Number of Adults: <span class="mandatory">*</span></label>
              <input type="number" id="adults" name="adults" required />
            </div>
            <div class="input-box">
              <label for="date">Date: <span class="mandatory">*</span></label>
              <input type="date" id="date" name="date" required />
            </div>
          </form>
        </div>
  
        <!-- Restaurant Service -->
        <div id="restaurantServiceRectangle" class="rectangle">
          <h3>Restaurant Service</h3>
          <form id="restaurantForm">
            <div class="input-box">
              <label for="itemName">Item Name: <span class="mandatory">*</span></label>
              <input type="text" id="itemName" name="itemName" required />
            </div>
            <div class="input-box">
              <label for="quantity">Quantity: <span class="mandatory">*</span></label>
              <input type="number" id="quantity" name="quantity" required />
            </div>
            <div class="input-box">
              <label for="totalPrice">Total Price: <span class="mandatory">*</span></label>
              <input type="number" id="totalPrice" name="totalPrice" required />
            </div>
            <div class="input-box">
              <label for="serviceDate">Date: <span class="mandatory">*</span></label>
              <input type="date" id="serviceDate" name="serviceDate" required />
            </div>
            <button type="button" class="button" onclick="addRestaurantItem()">+</button>
          </form>
  
          <table id="restaurantTable">
            <thead>
              <tr>
                <th>Item Name</th>
                <th>Quantity</th>
                <th>Total Price</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
  
        <!-- Water Service -->
        <div id="waterServiceRectangle" class="rectangle">
          <h3>Water</h3>
          <form id="waterForm">
            <div class="input-box">
              <label for="waterItem">Bottle Volume (L): <span class="mandatory">*</span></label>
              <input type="text" id="waterItem" name="waterItem" required />
            </div>
            <div class="input-box">
              <label for="waterQuantity">Quantity: <span class="mandatory">*</span></label>
              <input type="number" id="waterQuantity" name="waterQuantity" required />
            </div>
            <div class="input-box">
              <label for="waterPrice">Total Price: <span class="mandatory">*</span></label>
              <input type="number" id="waterPrice" name="waterPrice" required />
            </div>
            <div class="input-box">
              <label for="waterDate">Date: <span class="mandatory">*</span></label>
              <input type="date" id="waterDate" name="waterDate" required />
            </div>
            <button type="button" class="button" onclick="addWaterItem()">+</button>
          </form>
  
          <table id="waterTable">
            <thead>
              <tr>
                <th>Bottle Vol. (L)</th>
                <th>Quantity</th>
                <th>Total Price</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
  
        <!-- Laundry Service -->
        <div id="laundryServiceRectangle" class="rectangle">
          <h3>Laundry</h3>
          <form id="laundryForm">
            <div class="input-box">
            <label for="laundryItem">Cloth Item: <span class="mandatory">*</span></label>
            <input type="text" id="laundryItem" name="laundryItem" required />
            </div>
            <div class="input-box">
              <label for="laundryQuantity">Quantity: <span class="mandatory">*</span></label>
              <input type="number" id="laundryQuantity" name="laundryQuantity" required />
            </div>
            <div class="input-box">
              <label for="laundryPrice">Total Price: <span class="mandatory">*</span></label>
              <input type="number" id="laundryPrice" name="laundryPrice" required />
            </div>
            <div class="input-box">
              <label for="laundryDate">Date: <span class="mandatory">*</span></label>
              <input type="date" id="laundryDate" name="laundryDate" required />
            </div>
            <button type="button" class="button" onclick="addLaundryItem()">+</button>
          </form>
  
          <table id="laundryTable">
            <thead>
              <tr>
                <th>Cloth Item</th>
                <th>Quantity</th>
                <th>Total Price</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
  
      <div class="checkbtn">
        <button type="button" class="big-button" id="checkinBtn" onclick="checkIn()">CHECK-IN</button>
        <button type="button" class="big-button" id="checkoutBtn" onclick="checkOut()" disabled>CHECK-OUT</button>
      </div>
  
      <div id="summary" style="display: none;">
        <h3 style="text-align: center;">Total Bill</h3>
      
        <table style="margin: 0 auto; width: 50%;">
          <thead>
            <tr>
              <th>Services</th>
              <th>Total Price</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Restaurant</td>
              <td>₹<span id="restaurantTotal"></span></td>
            </tr>
            <tr>
              <td>Water</td>
              <td>₹<span id="waterTotal"></span></td>
            </tr>
            <tr>
              <td>Laundry</td>
              <td>₹<span id="laundryTotal"></span></td>
            </tr>
            <tr>
              <td><strong>Grand Total (₹)</strong></td>
              <td>₹<span id="grandTotal"></span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <script>
      const today = new Date().toLocaleDateString('en-CA');

      document.getElementById('date').value = today;
      document.getElementById('serviceDate').value = today;
      document.getElementById('waterDate').value = today;
      document.getElementById('laundryDate').value = today;
      // localStorage.setItem('serviceDate', document.getElementById('serviceDate').value);
      // localStorage.setItem('waterDate', document.getElementById('waterDate').value);
      // localStorage.setItem('laundryDate', document.getElementById('laundryDate').value);

     

      let restaurantTotal = 0;
      let waterTotal = 0;
      let laundryTotal = 0;
      let checkInStatus = false; 

      if(localStorage.getItem("personalDetails")) {
        const storedDetails = JSON.parse(localStorage.getItem("personalDetails"));
        document.getElementById('name').value = storedDetails.name;
        document.getElementById('adults').value = storedDetails.adults;
        document.getElementById('date').value = storedDetails.date;

        checkInStatus = true;
        document.getElementById('checkinBtn').disabled = true;
        document.getElementById('checkoutBtn').disabled = false;
        

        restaurantTotal = parseFloat(localStorage.getItem("restaurantTotal")) || 0;
        waterTotal = parseFloat(localStorage.getItem("waterTotal")) || 0;
        laundryTotal = parseFloat(localStorage.getItem("laundryTotal")) || 0;

        loadTable("restaurantTable", "restaurantService");
        loadTable("waterTable", "waterService");
        loadTable("laundryTable", "laundryService");
        updateF1R1Status();
      }

      function checkIn() {
        const personalDetails = {
          name: document.getElementById("name").value,
          adults: document.getElementById("adults").value,
          date: document.getElementById("date").value
        };

        if (!personalDetails.name || !personalDetails.adults || !personalDetails.date) {
          alert("Please fill in your personal details.");
          return;
        }

        localStorage.setItem("personalDetails", JSON.stringify(personalDetails));
        localStorage.setItem("checkInStatus", true);
        document.getElementById("name").disabled = true;
        document.getElementById("adults").disabled = true;
        document.getElementById("date").disabled = true;

        document.getElementById("checkinBtn").disabled = true;
        document.getElementById("checkoutBtn").disabled = false;
        checkInStatus = true;
        updateF1R1Status();  

      }

      function checkOut() {
        document.getElementById("summary").style.display = "block";
        document.getElementById("restaurantTotal").innerText = restaurantTotal;
        document.getElementById("waterTotal").innerText = waterTotal;
        document.getElementById("laundryTotal").innerText = laundryTotal;
        document.getElementById("grandTotal").innerText = (restaurantTotal + waterTotal + laundryTotal).toFixed(2);

        document.getElementById("checkoutBtn").disabled = true;
        clearServiceData();

        document.getElementById("checkinBtn").disabled = false;


        localStorage.removeItem("personalDetails");
        localStorage.removeItem("restaurantTotal");
        localStorage.removeItem("waterTotal");
        localStorage.removeItem("laundryTotal");
        localStorage.setItem("checkInStatus", false); 
        checkInStatus = false;
        updateF1R1Status(); 
      }
      function updateF1R1Status() {
        const f1r1Block = document.querySelector('.room.color');
        const checkInStatus = localStorage.getItem("checkInStatus") === 'true';
        if (checkInStatus) {
        } else {
        }
      }
      function loadTable(tableId, serviceType) {
        const table = document.getElementById(tableId).getElementsByTagName("tbody")[0];
        const services = JSON.parse(localStorage.getItem(serviceType)) || [];
        
        services.forEach(service => {
          const newRow = table.insertRow();
          newRow.innerHTML = `<td>${service.itemName}</td>
                              <td>${service.quantity}</td>
                              <td>${service.totalPrice}</td>
                              <td>${service.date}</td>`;
        });
      }

      function addRestaurantItem() {
        const itemName = document.getElementById("itemName").value;
        const quantity = parseInt(document.getElementById("quantity").value);
        const totalPrice = parseFloat(document.getElementById("totalPrice").value);
        const date = document.getElementById("serviceDate").value;
        // const serviceDate = localStorage.getItem('serviceDate');
        
        const newItem = { itemName, quantity, totalPrice, date };

        const services = JSON.parse(localStorage.getItem("restaurantService")) || [];
        services.push(newItem);
        localStorage.setItem("restaurantService", JSON.stringify(services));

        restaurantTotal += totalPrice;
        localStorage.setItem('restaurantTotal', restaurantTotal);

        const table = document.getElementById("restaurantTable").getElementsByTagName("tbody")[0];
        const newRow = table.insertRow();
        newRow.innerHTML = `<td>${itemName}</td><td>${quantity}</td><td>${totalPrice}</td><td>${date}</td>`;
        updateF1R1Status(); 
      }

      function addWaterItem() {
        const itemName = document.getElementById("waterItem").value;

        const quantity = parseInt(document.getElementById("waterQuantity").value);
        const totalPrice = parseFloat(document.getElementById("waterPrice").value);
        const date = document.getElementById("waterDate").value;
        
        // const waterDate = localStorage.getItem('waterDate');


        const newItem = { itemName, quantity, totalPrice, date };
        const services = JSON.parse(localStorage.getItem("waterService")) || [];
        services.push(newItem);
        localStorage.setItem("waterService", JSON.stringify(services));

        waterTotal += totalPrice;
        localStorage.setItem('waterTotal', waterTotal);


        const table = document.getElementById("waterTable").getElementsByTagName("tbody")[0];
        const newRow = table.insertRow();
        newRow.innerHTML = `<td>${itemName}</td><td>${quantity}</td><td>${totalPrice}</td><td>${date}</td>`;
        updateF1R1Status(); 
      }

      function addLaundryItem() {
        const itemName = document.getElementById("laundryItem").value;
        const quantity = parseInt(document.getElementById("laundryQuantity").value);
        const totalPrice = parseFloat(document.getElementById("laundryPrice").value);
        const date = document.getElementById("laundryDate").value;
        // console.log(typeof(laundryDate));


        const newItem = { itemName, quantity, totalPrice, date };
        const services = JSON.parse(localStorage.getItem("laundryService")) || [];
        services.push(newItem);
        localStorage.setItem("laundryService", JSON.stringify(services));

        laundryTotal += totalPrice;
        localStorage.setItem('laundryTotal', laundryTotal);

        const table = document.getElementById("laundryTable").getElementsByTagName("tbody")[0];
        const newRow = table.insertRow();
        newRow.innerHTML = `<td>${itemName}</td><td>${quantity}</td><td>${totalPrice}</td><td>${date}</td>`;
        updateF1R1Status(); 
        }

      function clearServiceData() {
        localStorage.removeItem("restaurantService");
        localStorage.removeItem("waterService");
        localStorage.removeItem("laundryService");
        localStorage.removeItem("personalDetails")
        localStorage.removeItem("restaurantTotal");
        localStorage.removeItem("waterTotal");
        localStorage.removeItem("laundryTotal");
        localStorage.removeItem('serviceDate');
        localStorage.removeItem('waterDate');
        localStorage.removeItem('laundryDate');
      }

 
    </script>
  </body>
</html>
